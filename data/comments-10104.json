[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1000357179",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10104#issuecomment-1000357179",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10104",
        "id": 1000357179,
        "node_id": "IC_kwDOCVq1mM47oD07",
        "user": {
            "login": "chausner-audeering",
            "id": 64791786,
            "node_id": "MDQ6VXNlcjY0NzkxNzg2",
            "avatar_url": "https://avatars.githubusercontent.com/u/64791786?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chausner-audeering",
            "html_url": "https://github.com/chausner-audeering",
            "followers_url": "https://api.github.com/users/chausner-audeering/followers",
            "following_url": "https://api.github.com/users/chausner-audeering/following{/other_user}",
            "gists_url": "https://api.github.com/users/chausner-audeering/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chausner-audeering/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chausner-audeering/subscriptions",
            "organizations_url": "https://api.github.com/users/chausner-audeering/orgs",
            "repos_url": "https://api.github.com/users/chausner-audeering/repos",
            "events_url": "https://api.github.com/users/chausner-audeering/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chausner-audeering/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-12-23T14:56:40Z",
        "updated_at": "2021-12-23T15:00:08Z",
        "author_association": "CONTRIBUTOR",
        "body": "I cannot reproduce this issue with onnxruntime 1.6.0. There, performance is consistently good. Version 1.7.0 is the first version where it occurs. Also, it does not occur with onnxruntime-openmp 1.7.0. So the issue is specific to the thread pool implementation in onnxruntime which became the default starting with 1.7.0.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1000357179/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1000470575",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10104#issuecomment-1000470575",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10104",
        "id": 1000470575,
        "node_id": "IC_kwDOCVq1mM47ofgv",
        "user": {
            "login": "chausner-audeering",
            "id": 64791786,
            "node_id": "MDQ6VXNlcjY0NzkxNzg2",
            "avatar_url": "https://avatars.githubusercontent.com/u/64791786?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chausner-audeering",
            "html_url": "https://github.com/chausner-audeering",
            "followers_url": "https://api.github.com/users/chausner-audeering/followers",
            "following_url": "https://api.github.com/users/chausner-audeering/following{/other_user}",
            "gists_url": "https://api.github.com/users/chausner-audeering/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chausner-audeering/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chausner-audeering/subscriptions",
            "organizations_url": "https://api.github.com/users/chausner-audeering/orgs",
            "repos_url": "https://api.github.com/users/chausner-audeering/repos",
            "events_url": "https://api.github.com/users/chausner-audeering/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chausner-audeering/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-12-23T18:40:30Z",
        "updated_at": "2021-12-23T23:51:04Z",
        "author_association": "CONTRIBUTOR",
        "body": "I looked into this further and noticed that the affinity mask that onnxruntime sets by default is not equivalent to `numactl --physcpubind=0,1,2,3`. onnxruntime assigns each thread to one single core while `numactl` assigns every thread to the same subset of cores. E.g.:\r\n```\r\nonnxruntime:\r\nthread 0: cpu 0\r\nthread 1: cpu 1\r\nthread 2: cpu 2\r\nthread 3: cpu 3\r\n\r\nnumactl --physcpubind=0,1,2,3:\r\nthread 0: cpus 0,1,2,3\r\nthread 1: cpus 0,1,2,3\r\nthread 2: cpus 0,1,2,3\r\nthread 3: cpus 0,1,2,3\r\n```\r\n\r\nIt appears the latter leads to better/more consistent performance in my case.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1000470575/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1000568580",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10104#issuecomment-1000568580",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10104",
        "id": 1000568580,
        "node_id": "IC_kwDOCVq1mM47o3cE",
        "user": {
            "login": "chausner-audeering",
            "id": 64791786,
            "node_id": "MDQ6VXNlcjY0NzkxNzg2",
            "avatar_url": "https://avatars.githubusercontent.com/u/64791786?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chausner-audeering",
            "html_url": "https://github.com/chausner-audeering",
            "followers_url": "https://api.github.com/users/chausner-audeering/followers",
            "following_url": "https://api.github.com/users/chausner-audeering/following{/other_user}",
            "gists_url": "https://api.github.com/users/chausner-audeering/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chausner-audeering/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chausner-audeering/subscriptions",
            "organizations_url": "https://api.github.com/users/chausner-audeering/orgs",
            "repos_url": "https://api.github.com/users/chausner-audeering/repos",
            "events_url": "https://api.github.com/users/chausner-audeering/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chausner-audeering/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-12-23T23:55:03Z",
        "updated_at": "2021-12-23T23:55:03Z",
        "author_association": "CONTRIBUTOR",
        "body": "I'll close this issue as the title has become misleading and my initial understanding of the issue was wrong. I will do some more benchmarks and might open a new issue instead.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1000568580/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]