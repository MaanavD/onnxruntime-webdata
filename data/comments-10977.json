[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1075727042",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10977#issuecomment-1075727042",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10977",
        "id": 1075727042,
        "node_id": "IC_kwDOCVq1mM5AHkrC",
        "user": {
            "login": "RandySheriffH",
            "id": 48490400,
            "node_id": "MDQ6VXNlcjQ4NDkwNDAw",
            "avatar_url": "https://avatars.githubusercontent.com/u/48490400?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/RandySheriffH",
            "html_url": "https://github.com/RandySheriffH",
            "followers_url": "https://api.github.com/users/RandySheriffH/followers",
            "following_url": "https://api.github.com/users/RandySheriffH/following{/other_user}",
            "gists_url": "https://api.github.com/users/RandySheriffH/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/RandySheriffH/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/RandySheriffH/subscriptions",
            "organizations_url": "https://api.github.com/users/RandySheriffH/orgs",
            "repos_url": "https://api.github.com/users/RandySheriffH/repos",
            "events_url": "https://api.github.com/users/RandySheriffH/events{/privacy}",
            "received_events_url": "https://api.github.com/users/RandySheriffH/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-03-22T22:49:27Z",
        "updated_at": "2022-03-22T22:49:27Z",
        "author_association": "MEMBER",
        "body": "@chenfucn : comments?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1075727042/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1075897251",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10977#issuecomment-1075897251",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10977",
        "id": 1075897251,
        "node_id": "IC_kwDOCVq1mM5AIOOj",
        "user": {
            "login": "chenfucn",
            "id": 1316708,
            "node_id": "MDQ6VXNlcjEzMTY3MDg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1316708?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chenfucn",
            "html_url": "https://github.com/chenfucn",
            "followers_url": "https://api.github.com/users/chenfucn/followers",
            "following_url": "https://api.github.com/users/chenfucn/following{/other_user}",
            "gists_url": "https://api.github.com/users/chenfucn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chenfucn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chenfucn/subscriptions",
            "organizations_url": "https://api.github.com/users/chenfucn/orgs",
            "repos_url": "https://api.github.com/users/chenfucn/repos",
            "events_url": "https://api.github.com/users/chenfucn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chenfucn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-03-23T04:15:41Z",
        "updated_at": "2022-03-23T04:15:41Z",
        "author_association": "MEMBER",
        "body": "I haven't worked on this part for over a year now. let me spend some time on this.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1075897251/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1075909809",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10977#issuecomment-1075909809",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10977",
        "id": 1075909809,
        "node_id": "IC_kwDOCVq1mM5AIRSx",
        "user": {
            "login": "chenfucn",
            "id": 1316708,
            "node_id": "MDQ6VXNlcjEzMTY3MDg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1316708?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chenfucn",
            "html_url": "https://github.com/chenfucn",
            "followers_url": "https://api.github.com/users/chenfucn/followers",
            "following_url": "https://api.github.com/users/chenfucn/following{/other_user}",
            "gists_url": "https://api.github.com/users/chenfucn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chenfucn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chenfucn/subscriptions",
            "organizations_url": "https://api.github.com/users/chenfucn/orgs",
            "repos_url": "https://api.github.com/users/chenfucn/repos",
            "events_url": "https://api.github.com/users/chenfucn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chenfucn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-03-23T04:45:48Z",
        "updated_at": "2022-03-23T04:45:48Z",
        "author_association": "MEMBER",
        "body": "ok here is the trade off: when the function TensorProtoToTensor is called, tensor memory is already allocated. In most cases onnxruntime pre-allocate memory for most tensors on one continuous memory region. This would greatly reduce memory fragmentation and also reduce memory usage. However this makes freeing individual tensor memory difficult. \r\n\r\nNow the case of directly mapping raw data to tensors, this requires extra memory holding that raw data to be held on for the life time of the tensor, which is forever.  It's a waste of memory, which is a bigger concern for us than loading time.\r\n\r\nSo we need a solution that only pre-allocate memory for tensors that can not be directly mapped. A year ago when I worked on this, this \"optimal\" solution need an overhaul of session initialization, for which we do not have resources.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1075909809/reactions",
            "total_count": 2,
            "+1": 2,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1076413994",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10977#issuecomment-1076413994",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10977",
        "id": 1076413994,
        "node_id": "IC_kwDOCVq1mM5AKMYq",
        "user": {
            "login": "kiennguyen94",
            "id": 11399832,
            "node_id": "MDQ6VXNlcjExMzk5ODMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/11399832?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kiennguyen94",
            "html_url": "https://github.com/kiennguyen94",
            "followers_url": "https://api.github.com/users/kiennguyen94/followers",
            "following_url": "https://api.github.com/users/kiennguyen94/following{/other_user}",
            "gists_url": "https://api.github.com/users/kiennguyen94/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kiennguyen94/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kiennguyen94/subscriptions",
            "organizations_url": "https://api.github.com/users/kiennguyen94/orgs",
            "repos_url": "https://api.github.com/users/kiennguyen94/repos",
            "events_url": "https://api.github.com/users/kiennguyen94/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kiennguyen94/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-03-23T14:03:39Z",
        "updated_at": "2022-03-23T14:03:39Z",
        "author_association": "CONTRIBUTOR",
        "body": "@chenfucn thank you for looking at this.\r\n\r\nWould you mind pointing to any design document or some more details on the optimal solution?  We would like to contribute if possible.\r\n\r\nI'll close the ticket for now. Appreciate you answering.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1076413994/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1076616988",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/10977#issuecomment-1076616988",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/10977",
        "id": 1076616988,
        "node_id": "IC_kwDOCVq1mM5AK98c",
        "user": {
            "login": "chenfucn",
            "id": 1316708,
            "node_id": "MDQ6VXNlcjEzMTY3MDg=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1316708?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chenfucn",
            "html_url": "https://github.com/chenfucn",
            "followers_url": "https://api.github.com/users/chenfucn/followers",
            "following_url": "https://api.github.com/users/chenfucn/following{/other_user}",
            "gists_url": "https://api.github.com/users/chenfucn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/chenfucn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/chenfucn/subscriptions",
            "organizations_url": "https://api.github.com/users/chenfucn/orgs",
            "repos_url": "https://api.github.com/users/chenfucn/repos",
            "events_url": "https://api.github.com/users/chenfucn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/chenfucn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2022-03-23T17:35:37Z",
        "updated_at": "2022-03-23T17:35:37Z",
        "author_association": "MEMBER",
        "body": "It was just an idea, probably I should not have used the word 'solution'. in session_state_utils.cc function SaveInitializedTensors computes the total memory needed for constant tensors. These are called initializers in the comments. We don't really know whether the initializers can be memory mapped or not when SaveInitializedTensors is called. So we have to allocate for all constant tensors.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/1076616988/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]