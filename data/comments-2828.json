[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/573897456",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-573897456",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 573897456,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3Mzg5NzQ1Ng==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-13T22:13:08Z",
        "updated_at": "2020-01-13T22:13:08Z",
        "author_association": "MEMBER",
        "body": "I can reproduce the bug without using nix.  \r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/573897456/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/573912603",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-573912603",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 573912603,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MzkxMjYwMw==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-13T22:56:05Z",
        "updated_at": "2020-01-13T22:56:05Z",
        "author_association": "MEMBER",
        "body": "As for now, I suggest you turn off onnxruntime_ENABLE_LTO. I believe it will solve the issue. \r\nI'll fix the bug (if it's possible), but as you know, 1.1.0 is already released, I can't change it. I can only fix it bug in master and wait for the next release.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/573912603/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/573932226",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-573932226",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 573932226,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3MzkzMjIyNg==",
        "user": {
            "login": "jonringer",
            "id": 7673602,
            "node_id": "MDQ6VXNlcjc2NzM2MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7673602?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonringer",
            "html_url": "https://github.com/jonringer",
            "followers_url": "https://api.github.com/users/jonringer/followers",
            "following_url": "https://api.github.com/users/jonringer/following{/other_user}",
            "gists_url": "https://api.github.com/users/jonringer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jonringer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jonringer/subscriptions",
            "organizations_url": "https://api.github.com/users/jonringer/orgs",
            "repos_url": "https://api.github.com/users/jonringer/repos",
            "events_url": "https://api.github.com/users/jonringer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jonringer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-13T23:59:24Z",
        "updated_at": "2020-01-13T23:59:24Z",
        "author_association": "NONE",
        "body": "That does seem to fix the build, although it's less than ideal ;(",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/573932226/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/573940944",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-573940944",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 573940944,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU3Mzk0MDk0NA==",
        "user": {
            "login": "jonringer",
            "id": 7673602,
            "node_id": "MDQ6VXNlcjc2NzM2MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7673602?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonringer",
            "html_url": "https://github.com/jonringer",
            "followers_url": "https://api.github.com/users/jonringer/followers",
            "following_url": "https://api.github.com/users/jonringer/following{/other_user}",
            "gists_url": "https://api.github.com/users/jonringer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jonringer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jonringer/subscriptions",
            "organizations_url": "https://api.github.com/users/jonringer/orgs",
            "repos_url": "https://api.github.com/users/jonringer/repos",
            "events_url": "https://api.github.com/users/jonringer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jonringer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-01-14T00:31:12Z",
        "updated_at": "2020-01-14T00:31:12Z",
        "author_association": "NONE",
        "body": "I'll leave the issue open until a PR closes it :)",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/573940944/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/585511138",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-585511138",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 585511138,
        "node_id": "MDEyOklzc3VlQ29tbWVudDU4NTUxMTEzOA==",
        "user": {
            "login": "jonringer",
            "id": 7673602,
            "node_id": "MDQ6VXNlcjc2NzM2MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7673602?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonringer",
            "html_url": "https://github.com/jonringer",
            "followers_url": "https://api.github.com/users/jonringer/followers",
            "following_url": "https://api.github.com/users/jonringer/following{/other_user}",
            "gists_url": "https://api.github.com/users/jonringer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jonringer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jonringer/subscriptions",
            "organizations_url": "https://api.github.com/users/jonringer/orgs",
            "repos_url": "https://api.github.com/users/jonringer/repos",
            "events_url": "https://api.github.com/users/jonringer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jonringer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-02-13T01:58:53Z",
        "updated_at": "2020-02-13T01:58:53Z",
        "author_association": "NONE",
        "body": "Still failing on 1.1.1:\r\n```\r\n[ RUN      ] CApiTest.dim_param\r\nonnxruntime_shared_lib_test: ../nptl/pthread_mutex_lock.c:144: __pthread_mutex_lock: Assertion `mutex->__data.__owner == 0' failed.\r\n\r\n7/7 Test #2: onnxruntime_test_all ................................................   Passed   17.94 sec\r\n\r\n86% tests passed, 1 tests failed out of 7\r\n\r\nTotal Test time (real) =  17.94 sec\r\n\r\nThe following tests FAILED:\r\n          7 - onnxruntime_shared_lib_test (Child aborted)\r\nErrors while running CTest\r\nmake: *** [Makefile:130: test] Error 8\r\nbuilder for '/nix/store/idij9j0lady0qhil9fpr8wcsqcgiml1h-onnxruntime-1.1.1.drv' failed with exit code 2\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/585511138/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/653347624",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-653347624",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 653347624,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1MzM0NzYyNA==",
        "user": {
            "login": "stale[bot]",
            "id": 26384082,
            "node_id": "MDM6Qm90MjYzODQwODI=",
            "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/stale%5Bbot%5D",
            "html_url": "https://github.com/apps/stale",
            "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
            "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
            "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
            "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
            "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
            "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
            "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
            "type": "Bot",
            "site_admin": false
        },
        "created_at": "2020-07-03T04:58:15Z",
        "updated_at": "2020-07-03T04:58:15Z",
        "author_association": "NONE",
        "body": "This issue has been automatically marked as stale due to inactivity and will be closed in 7 days if no further activity occurs. If further support is needed, please provide an update and/or more details.\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/653347624/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/653351741",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-653351741",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 653351741,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1MzM1MTc0MQ==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-03T05:10:03Z",
        "updated_at": "2020-07-03T05:10:03Z",
        "author_association": "MEMBER",
        "body": "I'm taking vacation now.  Will update this when I'm back. (about 10 days later).",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/653351741/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/658599153",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-658599153",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 658599153,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODU5OTE1Mw==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T07:33:44Z",
        "updated_at": "2020-07-15T07:33:44Z",
        "author_association": "MEMBER",
        "body": "Hi @jonringer , I just tested it again, it seems fine.\r\n\r\n```\r\ndiff --git a/pkgs/development/libraries/onnxruntime/default.nix b/pkgs/development/libraries/onnxruntime/default.nix\r\nindex 1794d55daaa..bcf4e2221f8 100644\r\n--- a/pkgs/development/libraries/onnxruntime/default.nix\r\n+++ b/pkgs/development/libraries/onnxruntime/default.nix\r\n@@ -42,7 +42,7 @@ stdenv.mkDerivation rec {\r\n     \"-Donnxruntime_USE_OPENMP=ON\"\r\n     \"-Donnxruntime_BUILD_SHARED_LIB=ON\"\r\n     # flip back to ON next release\r\n-    \"-Donnxruntime_ENABLE_LTO=OFF\" # https://github.com/microsoft/onnxruntime/issues/2828\r\n+    \"-Donnxruntime_ENABLE_LTO=ON\" # https://github.com/microsoft/onnxruntime/issues/2828\r\n   ];\r\n```\r\nonnxruntime version 1.3.1\r\nnixpkg version: dc1c3f3203b455f1abb62880ca925f1ccd1e9e2c\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/658599153/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/658939196",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-658939196",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 658939196,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODkzOTE5Ng==",
        "user": {
            "login": "jonringer",
            "id": 7673602,
            "node_id": "MDQ6VXNlcjc2NzM2MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7673602?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonringer",
            "html_url": "https://github.com/jonringer",
            "followers_url": "https://api.github.com/users/jonringer/followers",
            "following_url": "https://api.github.com/users/jonringer/following{/other_user}",
            "gists_url": "https://api.github.com/users/jonringer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jonringer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jonringer/subscriptions",
            "organizations_url": "https://api.github.com/users/jonringer/orgs",
            "repos_url": "https://api.github.com/users/jonringer/repos",
            "events_url": "https://api.github.com/users/jonringer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jonringer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T18:47:08Z",
        "updated_at": "2020-07-15T18:47:08Z",
        "author_association": "NONE",
        "body": "Thanks for even testing with nix :)",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/658939196/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/658993541",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-658993541",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 658993541,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODk5MzU0MQ==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T20:31:30Z",
        "updated_at": "2020-07-15T20:31:30Z",
        "author_association": "MEMBER",
        "body": "BTW, how the sha256 checksum was generated?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/658993541/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659036862",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-659036862",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 659036862,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTAzNjg2Mg==",
        "user": {
            "login": "jonringer",
            "id": 7673602,
            "node_id": "MDQ6VXNlcjc2NzM2MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7673602?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonringer",
            "html_url": "https://github.com/jonringer",
            "followers_url": "https://api.github.com/users/jonringer/followers",
            "following_url": "https://api.github.com/users/jonringer/following{/other_user}",
            "gists_url": "https://api.github.com/users/jonringer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jonringer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jonringer/subscriptions",
            "organizations_url": "https://api.github.com/users/jonringer/orgs",
            "repos_url": "https://api.github.com/users/jonringer/repos",
            "events_url": "https://api.github.com/users/jonringer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jonringer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T21:59:57Z",
        "updated_at": "2020-07-15T21:59:57Z",
        "author_association": "NONE",
        "body": "> BTW, how the sha256 checksum was generated?\r\n\r\nnix has a two-step build process, it creates a \"derivation\" which can be thought of all inputs that go into a package (include platform and architecture), and then uses that to actual build the package. When generating the derivation is when the sha256 is determined, it's assumed that the build outputs will be reproducible (in which most cases it's byte reproducible).\r\n\r\n```\r\n$ nix show-derivation $(nix-instantiate -A onnxruntime)\r\n{\r\n  \"/nix/store/2fn5ff46kjiqh8x32lr7cbv1rm09j92y-onnxruntime-1.3.1.drv\": {\r\n    \"outputs\": {\r\n      \"dev\": {\r\n        \"path\": \"/nix/store/cdb3y2dv6b7xnahj6k7xi3gx8f5kgzfk-onnxruntime-1.3.1-dev\"\r\n      },\r\n      \"out\": {\r\n        \"path\": \"/nix/store/cw01i1cf5j1wkyk4wdjv3g15cn3q9i3f-onnxruntime-1.3.1\"\r\n      }\r\n    },\r\n    \"inputSrcs\": [\r\n      \"/nix/store/9krlzvny65gdc8s7kpb6lkx8cd02c25b-default-builder.sh\"\r\n    ],\r\n    \"inputDrvs\": {\r\n      \"/nix/store/0i02lv650zkj5vipi2a53r5rn1rpcab8-source.drv\": [\r\n        \"out\"\r\n      ],\r\n      \"/nix/store/3cac569dbmvrwn2w2w27s1g0fzlk8aw2-libpng-apng-1.6.37.drv\": [\r\n        \"dev\"\r\n      ],\r\n      \"/nix/store/840fpgnd7szrjl7m1dj80gz1bwzih0kd-cmake-3.17.3.drv\": [\r\n        \"out\"\r\n      ],\r\n      \"/nix/store/hpr02w51r1kqyvvzmpk38iq5d4f58j40-python3-3.8.3.drv\": [\r\n        \"out\"\r\n      ],\r\n      \"/nix/store/lbz40vy8q4a85xj6i8x3a9pzbn6lxnpl-glibc-locales-2.31.drv\": [\r\n        \"out\"\r\n      ],\r\n      \"/nix/store/q1b3xsrc01nx9jlsy8ydzvfg26h5zf2c-zlib-1.2.11.drv\": [\r\n        \"dev\"\r\n      ],\r\n      \"/nix/store/ylvnhnd5nrbqn40kyrvvs9mrsq9m2xmr-bash-4.4-p23.drv\": [\r\n        \"out\"\r\n      ],\r\n      \"/nix/store/yq69lshldnwb2pcscbn069xm3v6s27hk-stdenv-linux.drv\": [\r\n        \"out\"\r\n      ]\r\n    },\r\n    \"platform\": \"x86_64-linux\",\r\n    \"builder\": \"/nix/store/c4wxsn4jays9j31y5z9f83nr2cp7l4pa-bash-4.4-p23/bin/bash\",\r\n    \"args\": [\r\n      \"-e\",\r\n      \"/nix/store/9krlzvny65gdc8s7kpb6lkx8cd02c25b-default-builder.sh\"\r\n    ],\r\n    \"env\": {\r\n      \"buildInputs\": \"/nix/store/73ni62ps2sws6nvxgxmmlxdajzwy1cfa-libpng-apng-1.6.37-dev /nix/store/fn0kwfwaf53638xm37wl94la8dxlbjaq-zlib-1.2.11-dev\",\r\n      \"builder\": \"/nix/store/c4wxsn4jays9j31y5z9f83nr2cp7l4pa-bash-4.4-p23/bin/bash\",\r\n      \"cmakeDir\": \"../cmake\",\r\n      \"cmakeFlags\": \"-Donnxruntime_USE_OPENMP=ON -Donnxruntime_BUILD_SHARED_LIB=ON -Donnxruntime_ENABLE_LTO=ON\",\r\n      \"configureFlags\": \"\",\r\n      \"depsBuildBuild\": \"\",\r\n      \"depsBuildBuildPropagated\": \"\",\r\n      \"depsBuildTarget\": \"\",\r\n      \"depsBuildTargetPropagated\": \"\",\r\n      \"depsHostHost\": \"\",\r\n      \"depsHostHostPropagated\": \"\",\r\n      \"depsTargetTarget\": \"\",\r\n      \"depsTargetTargetPropagated\": \"\",\r\n      \"dev\": \"/nix/store/cdb3y2dv6b7xnahj6k7xi3gx8f5kgzfk-onnxruntime-1.3.1-dev\",\r\n      \"doCheck\": \"1\",\r\n      \"doInstallCheck\": \"\",\r\n      \"enableParallelBuilding\": \"1\",\r\n      \"enableParallelChecking\": \"1\",\r\n      \"name\": \"onnxruntime-1.3.1\",\r\n      \"nativeBuildInputs\": \"/nix/store/mfz8nm7dwrk1744hv1saak28alsi08xc-cmake-3.17.3 /nix/store/7q4crsd8kvmma32ff2xw4w9ydj5k26cy-python3-3.8.3\",\r\n      \"out\": \"/nix/store/cw01i1cf5j1wkyk4wdjv3g15cn3q9i3f-onnxruntime-1.3.1\",\r\n      \"outputs\": \"out dev\",\r\n      \"patches\": \"\",\r\n      \"pname\": \"onnxruntime\",\r\n      \"postInstall\": \"rm -r $out/bin   # ctest runner\\n\",\r\n      \"preCheck\": \"export LOCALE_ARCHIVE=\\\"/nix/store/4p9w65np73bynmmq98nn2z1an0py0jvn-glibc-locales-2.31/lib/locale/locale-archive\\\"\\n\",\r\n      \"propagatedBuildInputs\": \"\",\r\n      \"propagatedNativeBuildInputs\": \"\",\r\n      \"src\": \"/nix/store/1ijccjqv5rkspng6k2dqrp05yp984dk7-source\",\r\n      \"stdenv\": \"/nix/store/b21rxw41g7fi90bzz7fd063wy115x1yq-stdenv-linux\",\r\n      \"strictDeps\": \"\",\r\n      \"system\": \"x86_64-linux\",\r\n      \"version\": \"1.3.1\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nSince the sha encapsulates all inputs and configurations for every input. A new sha will be generated if one of the inputs change. For example, if I were to use clang to build onnxruntime:\r\n```\r\n[14:53:56] jon@jon-desktop /home/jon/projects/nixpkgs (onnxruntime-enable-lto)\r\n$ nix-instantiate -E 'with import ./. {}; onnxruntime'\r\n/nix/store/2fn5ff46kjiqh8x32lr7cbv1rm09j92y-onnxruntime-1.3.1.drv\r\n[14:54:04] jon@jon-desktop /home/jon/projects/nixpkgs (onnxruntime-enable-lto)\r\n$ nix-instantiate -E 'with import ./. {}; onnxruntime.override { stdenv = clangStdenv; }'\r\n/nix/store/q3vs6071j95ss847qp5h4x2w8rfaz4cr-onnxruntime-1.3.1.drv\r\n```\r\n\r\nThis also makes the build outputs content addressable, by default nix tools will ask the cdn if a particular package exists and is free to download it, as it should be the same as building it locally. (there's some signing in this case to ensure the build output wasn't tampered)",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659036862/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659042830",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-659042830",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 659042830,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTA0MjgzMA==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T22:15:45Z",
        "updated_at": "2020-07-15T22:15:45Z",
        "author_association": "MEMBER",
        "body": "What if, for example, I want to submit a change to update onnxruntime to 1.4.0, how can I get the sha256 value of the new version?\r\nNow 1.4 isn't released yet, but we have created the release branch. How can we test it with nixpkg before the final tag is cut?\r\n\r\nThanks.\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659042830/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659056020",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-659056020",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 659056020,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTA1NjAyMA==",
        "user": {
            "login": "jonringer",
            "id": 7673602,
            "node_id": "MDQ6VXNlcjc2NzM2MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7673602?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonringer",
            "html_url": "https://github.com/jonringer",
            "followers_url": "https://api.github.com/users/jonringer/followers",
            "following_url": "https://api.github.com/users/jonringer/following{/other_user}",
            "gists_url": "https://api.github.com/users/jonringer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jonringer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jonringer/subscriptions",
            "organizations_url": "https://api.github.com/users/jonringer/orgs",
            "repos_url": "https://api.github.com/users/jonringer/repos",
            "events_url": "https://api.github.com/users/jonringer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jonringer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T22:55:15Z",
        "updated_at": "2020-07-15T22:55:15Z",
        "author_association": "NONE",
        "body": ">  How can we test it with nixpkg before the final tag is cut?\r\n\r\nif you have a local checkout, you can do something like this, (ignore version, the channel hasn't updated):\r\n```\r\nnix-build -E 'with import <nixpkgs> {}; onnxruntime.overrideAttrs(oldAttrs: { src = ./.; })'\r\nthese derivations will be built:\r\n  /nix/store/jaswk0yjx3s6q2h3bz2irhvv8khpdiqg-onnxruntime-1.2.0.drv\r\nbuilding '/nix/store/jaswk0yjx3s6q2h3bz2irhvv8khpdiqg-onnxruntime-1.2.0.drv'...\r\n```\r\nand this will build with the code located at $PWD as the src\r\n\r\n> What if, for example, I want to submit a change to update onnxruntime to 1.4.0, how can I get the sha256 value of the new version?\r\n\r\nFor normal `*.tar.gz` urls, there's a `nix-prefetch-url` command which is able to do this. For onnxruntime, I'm fetching submodules, and for reproducibility, nix will throw away the `.git*`; so I'm not aware of a good way to determine this. For packaging, I just invalidate the sha256, and nix will tell me that it expected after it pulled down the new source, however, it's not an automated process. I would use the `src = ./.;` code above.\r\n\r\n\r\nTaking a step back, it looks like I will have to touch-up the inputs, as flake8 is now required\r\n```\r\nCMake Warning at flake8.cmake:19 (message):\r\n  Could not find 'flake8' to check python scripts.  Please install flake8\r\n  using pip.\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659056020/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659059902",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-659059902",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 659059902,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTA1OTkwMg==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T23:07:15Z",
        "updated_at": "2020-07-15T23:07:15Z",
        "author_association": "MEMBER",
        "body": "flake8 is only used for detecting code style issue, if you don't do development on onnxruntime, you don't need it. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659059902/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659061011",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-659061011",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 659061011,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTA2MTAxMQ==",
        "user": {
            "login": "jonringer",
            "id": 7673602,
            "node_id": "MDQ6VXNlcjc2NzM2MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7673602?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonringer",
            "html_url": "https://github.com/jonringer",
            "followers_url": "https://api.github.com/users/jonringer/followers",
            "following_url": "https://api.github.com/users/jonringer/following{/other_user}",
            "gists_url": "https://api.github.com/users/jonringer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jonringer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jonringer/subscriptions",
            "organizations_url": "https://api.github.com/users/jonringer/orgs",
            "repos_url": "https://api.github.com/users/jonringer/repos",
            "events_url": "https://api.github.com/users/jonringer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jonringer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T23:10:46Z",
        "updated_at": "2020-07-15T23:11:51Z",
        "author_association": "NONE",
        "body": "sorry, didn't run `$ git submodule update --init`, so it was actually failing on missing submodules",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659061011/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659068808",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/2828#issuecomment-659068808",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/2828",
        "id": 659068808,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTA2ODgwOA==",
        "user": {
            "login": "jonringer",
            "id": 7673602,
            "node_id": "MDQ6VXNlcjc2NzM2MDI=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7673602?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonringer",
            "html_url": "https://github.com/jonringer",
            "followers_url": "https://api.github.com/users/jonringer/followers",
            "following_url": "https://api.github.com/users/jonringer/following{/other_user}",
            "gists_url": "https://api.github.com/users/jonringer/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jonringer/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jonringer/subscriptions",
            "organizations_url": "https://api.github.com/users/jonringer/orgs",
            "repos_url": "https://api.github.com/users/jonringer/repos",
            "events_url": "https://api.github.com/users/jonringer/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jonringer/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-07-15T23:34:55Z",
        "updated_at": "2020-07-15T23:34:55Z",
        "author_association": "NONE",
        "body": "also, looks likes there's a community tool for doing the github prefetch:\r\n```\r\n$ nix-shell -p nix-prefetch-github --run \"nix-prefetch-github --fetch-submodules --rev v1.3.1 microsoft onnxruntime\"\r\n{\r\n    \"owner\": \"microsoft\",\r\n    \"repo\": \"onnxruntime\",\r\n    \"rev\": \"530117cfdb230228c3429ab39d1b7cf1f68c0567\",\r\n    \"sha256\": \"03c5h5pp67a51blc26kw08piax81116jp7l2illzrsnx0580m6ri\",\r\n    \"fetchSubmodules\": true\r\n}\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/659068808/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]