[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/668097905",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4689#issuecomment-668097905",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4689",
        "id": 668097905,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODA5NzkwNQ==",
        "user": {
            "login": "liqunfu",
            "id": 3318051,
            "node_id": "MDQ6VXNlcjMzMTgwNTE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3318051?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/liqunfu",
            "html_url": "https://github.com/liqunfu",
            "followers_url": "https://api.github.com/users/liqunfu/followers",
            "following_url": "https://api.github.com/users/liqunfu/following{/other_user}",
            "gists_url": "https://api.github.com/users/liqunfu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/liqunfu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/liqunfu/subscriptions",
            "organizations_url": "https://api.github.com/users/liqunfu/orgs",
            "repos_url": "https://api.github.com/users/liqunfu/repos",
            "events_url": "https://api.github.com/users/liqunfu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/liqunfu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-03T15:49:44Z",
        "updated_at": "2020-08-03T15:49:44Z",
        "author_association": "MEMBER",
        "body": "did you have to call graph.Resolve()?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/668097905/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/668393172",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4689#issuecomment-668393172",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4689",
        "id": 668393172,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODM5MzE3Mg==",
        "user": {
            "login": "Dudeldu",
            "id": 18610449,
            "node_id": "MDQ6VXNlcjE4NjEwNDQ5",
            "avatar_url": "https://avatars.githubusercontent.com/u/18610449?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Dudeldu",
            "html_url": "https://github.com/Dudeldu",
            "followers_url": "https://api.github.com/users/Dudeldu/followers",
            "following_url": "https://api.github.com/users/Dudeldu/following{/other_user}",
            "gists_url": "https://api.github.com/users/Dudeldu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Dudeldu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Dudeldu/subscriptions",
            "organizations_url": "https://api.github.com/users/Dudeldu/orgs",
            "repos_url": "https://api.github.com/users/Dudeldu/repos",
            "events_url": "https://api.github.com/users/Dudeldu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Dudeldu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-04T05:48:32Z",
        "updated_at": "2020-08-04T05:48:32Z",
        "author_association": "CONTRIBUTOR",
        "body": "graph.Resolve should be called, when the `modified` value is set to true anyways, as far as I can see. But even with explicitly calling Resolve the problem persits",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/668393172/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/670053068",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4689#issuecomment-670053068",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4689",
        "id": 670053068,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3MDA1MzA2OA==",
        "user": {
            "login": "liqunfu",
            "id": 3318051,
            "node_id": "MDQ6VXNlcjMzMTgwNTE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3318051?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/liqunfu",
            "html_url": "https://github.com/liqunfu",
            "followers_url": "https://api.github.com/users/liqunfu/followers",
            "following_url": "https://api.github.com/users/liqunfu/following{/other_user}",
            "gists_url": "https://api.github.com/users/liqunfu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/liqunfu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/liqunfu/subscriptions",
            "organizations_url": "https://api.github.com/users/liqunfu/orgs",
            "repos_url": "https://api.github.com/users/liqunfu/repos",
            "events_url": "https://api.github.com/users/liqunfu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/liqunfu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-06T16:59:36Z",
        "updated_at": "2020-08-06T16:59:36Z",
        "author_association": "MEMBER",
        "body": "Please take a look at this example to see what you may have missed:\r\n[https://github.com/microsoft/onnxruntime/blob/7f5339505e146bfd303b629cd8f7d052ac72b461/onnxruntime/test/ir/graph_test.cc#L1321](url)",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/670053068/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/670341653",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4689#issuecomment-670341653",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4689",
        "id": 670341653,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3MDM0MTY1Mw==",
        "user": {
            "login": "Dudeldu",
            "id": 18610449,
            "node_id": "MDQ6VXNlcjE4NjEwNDQ5",
            "avatar_url": "https://avatars.githubusercontent.com/u/18610449?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Dudeldu",
            "html_url": "https://github.com/Dudeldu",
            "followers_url": "https://api.github.com/users/Dudeldu/followers",
            "following_url": "https://api.github.com/users/Dudeldu/following{/other_user}",
            "gists_url": "https://api.github.com/users/Dudeldu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Dudeldu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Dudeldu/subscriptions",
            "organizations_url": "https://api.github.com/users/Dudeldu/orgs",
            "repos_url": "https://api.github.com/users/Dudeldu/repos",
            "events_url": "https://api.github.com/users/Dudeldu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Dudeldu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-07T05:58:48Z",
        "updated_at": "2020-08-07T05:58:48Z",
        "author_association": "CONTRIBUTOR",
        "body": "I went through the test case, but as far as i can see, the main calls are identical (mainly graph.Resolve()). The only difference is the general setup.\r\nFor me the `SetOutputs` and the basic graph transformations (as tested in the TestCase inked) work, at least some kind of, as exporting the optimized model right after all transformation results in the expected ONNX model file, **BUT** the runtime session further goes with the old outputs. I would guess it somehow doesn't update the outputs after the transformations, please correct me if i'm wrong? ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/670341653/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/670976168",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/4689#issuecomment-670976168",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/4689",
        "id": 670976168,
        "node_id": "MDEyOklzc3VlQ29tbWVudDY3MDk3NjE2OA==",
        "user": {
            "login": "Dudeldu",
            "id": 18610449,
            "node_id": "MDQ6VXNlcjE4NjEwNDQ5",
            "avatar_url": "https://avatars.githubusercontent.com/u/18610449?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Dudeldu",
            "html_url": "https://github.com/Dudeldu",
            "followers_url": "https://api.github.com/users/Dudeldu/followers",
            "following_url": "https://api.github.com/users/Dudeldu/following{/other_user}",
            "gists_url": "https://api.github.com/users/Dudeldu/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Dudeldu/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Dudeldu/subscriptions",
            "organizations_url": "https://api.github.com/users/Dudeldu/orgs",
            "repos_url": "https://api.github.com/users/Dudeldu/repos",
            "events_url": "https://api.github.com/users/Dudeldu/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Dudeldu/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2020-08-08T21:34:20Z",
        "updated_at": "2020-08-10T09:28:35Z",
        "author_association": "CONTRIBUTOR",
        "body": "I dug deeper into the onnxruntime inference_session with the following result:\r\nThe output names, that can be fetched from the C++ API are served from the private attribute `output_def_list_`of `inference_session`\r\nhttps://github.com/microsoft/onnxruntime/blob/abbb7f6f5cfa69737c57363788f5ae712d3e1788/onnxruntime/core/session/inference_session.cc#L1333-L1343\r\n\r\nThe graph transformations are applied in the `Initialize`. Afterwards the graph gets (correctly) resolved, partitioned and finalized etc.\r\nhttps://github.com/microsoft/onnxruntime/blob/abbb7f6f5cfa69737c57363788f5ae712d3e1788/onnxruntime/core/session/inference_session.cc#L921-L928\r\n**BUT** as far as i can see, the `output_def_list_` is never updated during this whole process and therefore provides wrong information about the ouput definitions e.g.: after rename. Only write access inside the `SaveModelMetadata` function (as well as other attributes like `model_output_names_`) that is only called after the model was loaded https://github.com/microsoft/onnxruntime/blob/abbb7f6f5cfa69737c57363788f5ae712d3e1788/onnxruntime/core/session/inference_session.cc#L1453  \r\nThe same problem doesn't occure with inputs, as here the definitions are requested on demand right from the current graph, which would be a fix for this problem as well.\r\nhttps://github.com/microsoft/onnxruntime/blob/abbb7f6f5cfa69737c57363788f5ae712d3e1788/onnxruntime/core/session/inference_session.cc#L1317\r\n\r\n**Can someone confirm that or correct me?**",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/670976168/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]