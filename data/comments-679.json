[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/475845995",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-475845995",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 475845995,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTg0NTk5NQ==",
        "user": {
            "login": "pranavsharma",
            "id": 2732907,
            "node_id": "MDQ6VXNlcjI3MzI5MDc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2732907?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pranavsharma",
            "html_url": "https://github.com/pranavsharma",
            "followers_url": "https://api.github.com/users/pranavsharma/followers",
            "following_url": "https://api.github.com/users/pranavsharma/following{/other_user}",
            "gists_url": "https://api.github.com/users/pranavsharma/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/pranavsharma/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/pranavsharma/subscriptions",
            "organizations_url": "https://api.github.com/users/pranavsharma/orgs",
            "repos_url": "https://api.github.com/users/pranavsharma/repos",
            "events_url": "https://api.github.com/users/pranavsharma/events{/privacy}",
            "received_events_url": "https://api.github.com/users/pranavsharma/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-03-23T07:00:31Z",
        "updated_at": "2019-03-23T07:00:31Z",
        "author_association": "MEMBER",
        "body": "@wenbingl @EmmaNingMS can someone from the converter team take a look? thanks!\r\n@dashesy btw, we don't support python 2. can you check if you see the same issue with python 3.x?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/475845995/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/476304345",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-476304345",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 476304345,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjMwNDM0NQ==",
        "user": {
            "login": "wenbingl",
            "id": 10278425,
            "node_id": "MDQ6VXNlcjEwMjc4NDI1",
            "avatar_url": "https://avatars.githubusercontent.com/u/10278425?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wenbingl",
            "html_url": "https://github.com/wenbingl",
            "followers_url": "https://api.github.com/users/wenbingl/followers",
            "following_url": "https://api.github.com/users/wenbingl/following{/other_user}",
            "gists_url": "https://api.github.com/users/wenbingl/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wenbingl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wenbingl/subscriptions",
            "organizations_url": "https://api.github.com/users/wenbingl/orgs",
            "repos_url": "https://api.github.com/users/wenbingl/repos",
            "events_url": "https://api.github.com/users/wenbingl/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wenbingl/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-03-25T17:38:54Z",
        "updated_at": "2019-03-25T17:38:54Z",
        "author_association": "MEMBER",
        "body": "@pranavsharma, this is exported from torch model, @faxu can we find any contractor who are working on pytorch exporter?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/476304345/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/476406912",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-476406912",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 476406912,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjQwNjkxMg==",
        "user": {
            "login": "spandantiwari",
            "id": 23646532,
            "node_id": "MDQ6VXNlcjIzNjQ2NTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/23646532?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/spandantiwari",
            "html_url": "https://github.com/spandantiwari",
            "followers_url": "https://api.github.com/users/spandantiwari/followers",
            "following_url": "https://api.github.com/users/spandantiwari/following{/other_user}",
            "gists_url": "https://api.github.com/users/spandantiwari/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/spandantiwari/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/spandantiwari/subscriptions",
            "organizations_url": "https://api.github.com/users/spandantiwari/orgs",
            "repos_url": "https://api.github.com/users/spandantiwari/repos",
            "events_url": "https://api.github.com/users/spandantiwari/events{/privacy}",
            "received_events_url": "https://api.github.com/users/spandantiwari/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-03-25T22:48:15Z",
        "updated_at": "2019-03-25T22:48:15Z",
        "author_association": "NONE",
        "body": "@dashesy - Yes, this tracer warning is coming from PyTorch exporter and we have seen this before. Most of the times this warning is legitimate in that the JIT tracer cannot accurately capture the semantics of the dynamic ops, like the indexing op you show in your example, and instead captures a static constant for that specific run. This is what the warning is about. I think the tracer warning is pointing to a legit concern here. See the \"Limitations\" section in this [PyTorch page.](https://pytorch.org/docs/master/onnx.html?highlight=onnx#module-torch.onnx)\r\n\r\nThe recommended way to capture this dynamic behavior is to use [TorchScript](https://pytorch.org/docs/stable/jit.htmlhttps://pytorch.org/docs/stable/jit.html) in the export. Here's an example, that shows slicing, that shows the use of TorchScript:\r\n```\r\n@torch.jit.script\r\ndef slice_helper(x, offset ):\r\n    return x[:offset ]\r\n\r\nclass CenterCrop(torch.nn.Module):\r\n    def __init__(self, crop_size):\r\n        \"\"\"Crop from the center of a 4d tensor\r\n        :param crop_size: the center crop size\r\n        \"\"\"\r\n        super(CenterCrop, self).__init__()\r\n        self.crop_size = crop_size\r\n    \r\ndef forward(self, x):\r\n        offset = (x.shape[2] - self.crop_size) / 2\r\n        return slice_helper(x, offset )\r\n```",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/476406912/reactions",
            "total_count": 3,
            "+1": 3,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/476442986",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-476442986",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 476442986,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjQ0Mjk4Ng==",
        "user": {
            "login": "dashesy",
            "id": 873905,
            "node_id": "MDQ6VXNlcjg3MzkwNQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/873905?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dashesy",
            "html_url": "https://github.com/dashesy",
            "followers_url": "https://api.github.com/users/dashesy/followers",
            "following_url": "https://api.github.com/users/dashesy/following{/other_user}",
            "gists_url": "https://api.github.com/users/dashesy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dashesy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dashesy/subscriptions",
            "organizations_url": "https://api.github.com/users/dashesy/orgs",
            "repos_url": "https://api.github.com/users/dashesy/repos",
            "events_url": "https://api.github.com/users/dashesy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dashesy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-03-26T01:53:05Z",
        "updated_at": "2019-03-26T01:53:05Z",
        "author_association": "NONE",
        "body": "That makes sense for indexing, but what about the warning about assert statement? \r\n\r\n> assert x.shape[2] == x.shape[3] and x.shape[2] > self.crop_size + 2\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/476442986/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/478098705",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-478098705",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 478098705,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ3ODA5ODcwNQ==",
        "user": {
            "login": "spandantiwari",
            "id": 23646532,
            "node_id": "MDQ6VXNlcjIzNjQ2NTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/23646532?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/spandantiwari",
            "html_url": "https://github.com/spandantiwari",
            "followers_url": "https://api.github.com/users/spandantiwari/followers",
            "following_url": "https://api.github.com/users/spandantiwari/following{/other_user}",
            "gists_url": "https://api.github.com/users/spandantiwari/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/spandantiwari/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/spandantiwari/subscriptions",
            "organizations_url": "https://api.github.com/users/spandantiwari/orgs",
            "repos_url": "https://api.github.com/users/spandantiwari/repos",
            "events_url": "https://api.github.com/users/spandantiwari/events{/privacy}",
            "received_events_url": "https://api.github.com/users/spandantiwari/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-03-29T18:14:39Z",
        "updated_at": "2019-03-29T18:14:39Z",
        "author_association": "NONE",
        "body": "I think it is the same root cause. Once this is a ScriptModule I expect to see this warning to go away as well.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/478098705/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/481051166",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-481051166",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 481051166,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MTA1MTE2Ng==",
        "user": {
            "login": "spandantiwari",
            "id": 23646532,
            "node_id": "MDQ6VXNlcjIzNjQ2NTMy",
            "avatar_url": "https://avatars.githubusercontent.com/u/23646532?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/spandantiwari",
            "html_url": "https://github.com/spandantiwari",
            "followers_url": "https://api.github.com/users/spandantiwari/followers",
            "following_url": "https://api.github.com/users/spandantiwari/following{/other_user}",
            "gists_url": "https://api.github.com/users/spandantiwari/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/spandantiwari/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/spandantiwari/subscriptions",
            "organizations_url": "https://api.github.com/users/spandantiwari/orgs",
            "repos_url": "https://api.github.com/users/spandantiwari/repos",
            "events_url": "https://api.github.com/users/spandantiwari/events{/privacy}",
            "received_events_url": "https://api.github.com/users/spandantiwari/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-09T00:03:19Z",
        "updated_at": "2019-04-09T00:03:19Z",
        "author_association": "NONE",
        "body": "Closing this. @dashesy - Please reopen if this is still an issue.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/481051166/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/481496383",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-481496383",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 481496383,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MTQ5NjM4Mw==",
        "user": {
            "login": "dashesy",
            "id": 873905,
            "node_id": "MDQ6VXNlcjg3MzkwNQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/873905?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dashesy",
            "html_url": "https://github.com/dashesy",
            "followers_url": "https://api.github.com/users/dashesy/followers",
            "following_url": "https://api.github.com/users/dashesy/following{/other_user}",
            "gists_url": "https://api.github.com/users/dashesy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dashesy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dashesy/subscriptions",
            "organizations_url": "https://api.github.com/users/dashesy/orgs",
            "repos_url": "https://api.github.com/users/dashesy/repos",
            "events_url": "https://api.github.com/users/dashesy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dashesy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-10T01:17:53Z",
        "updated_at": "2019-04-10T01:17:53Z",
        "author_association": "NONE",
        "body": "@spandantiwari I changed the code to this\r\n\r\n```python\r\n@torch.jit.script\r\ndef center_slice_helper(x, h_offset, w_offset, crop_size):\r\n    return x[:, :, h_offset:h_offset + crop_size, w_offset:w_offset + crop_size]\r\n\r\n\r\nclass CenterCrop(nn.Module):\r\n    def __init__(self, crop_size):\r\n        \"\"\"Crop from the center of a 4d tensor\r\n        :param crop_size: the center crop size\r\n        \"\"\"\r\n        super(CenterCrop, self).__init__()\r\n        self.crop_size = crop_size\r\n\r\n    def extra_repr(self):\r\n        \"\"\"Extra information\r\n        \"\"\"\r\n        return 'crop_size={}'.format(\r\n            self.crop_size\r\n        )\r\n\r\n    def forward(self, x):\r\n        assert x.shape[3] > self.crop_size + 2 and x.shape[2] > self.crop_size + 2, \\\r\n            \"height: {} or width: {} is less than crop_size: {}\".format(x.shape[2], x.shape[3], self.crop_size)\r\n        h_offset = torch.tensor((x.shape[2] - self.crop_size) / 2)\r\n        w_offset = torch.tensor((x.shape[3] - self.crop_size) / 2)\r\n        return center_slice_helper(x, h_offset, w_offset, torch.tensor(self.crop_size))\r\n```\r\n\r\nI think it now respects dynamic sizes, but it does not remove warning unless I move the assert to the `center_slice_helper` torch script. \r\n\r\n> TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not  generalize to other inputs!                                                                                                                                                                                                                                                      > assert x.shape[3] > self.crop_size + 2 and x.shape[2] > self.crop_size + 2, \\\r\n\r\n\r\n\r\n\r\nAlso, I have to convert to `torch.tensor()` (as in the above script) or will get an another error:\r\n\r\n> RuntimeError: center_slice_helper() expected value of type Tensor for argument 'h_offset' in position 1, but instead got value of type int.                                                                                                                                     > Value: 16                                                                                                                                                                                                                                                                       >Declaration: center_slice_helper(Tensor x, Tensor h_offset, Tensor w_offset, Tensor crop_size) -> Tensor\r\n\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/481496383/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/481496968",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-481496968",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 481496968,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MTQ5Njk2OA==",
        "user": {
            "login": "dashesy",
            "id": 873905,
            "node_id": "MDQ6VXNlcjg3MzkwNQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/873905?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dashesy",
            "html_url": "https://github.com/dashesy",
            "followers_url": "https://api.github.com/users/dashesy/followers",
            "following_url": "https://api.github.com/users/dashesy/following{/other_user}",
            "gists_url": "https://api.github.com/users/dashesy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dashesy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dashesy/subscriptions",
            "organizations_url": "https://api.github.com/users/dashesy/orgs",
            "repos_url": "https://api.github.com/users/dashesy/repos",
            "events_url": "https://api.github.com/users/dashesy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dashesy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-10T01:21:11Z",
        "updated_at": "2019-04-10T01:24:29Z",
        "author_association": "NONE",
        "body": "Actually I get this error too:\r\n\r\n> h_offset = torch.tensor((x.shape[2] - self.crop_size) / 2)                                                                                                                                                                                                                    mtorch/deploy/transform_ops.py:62: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function\r\n\r\nSo it is not respecting dynamic sizes?\r\n\r\n\r\nCan you please re-open the issue, or let me know how to fix it?\r\n\r\nAlso, let me know if I should open issue in other repo?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/481496968/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/833372233",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/679#issuecomment-833372233",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/679",
        "id": 833372233,
        "node_id": "MDEyOklzc3VlQ29tbWVudDgzMzM3MjIzMw==",
        "user": {
            "login": "9lan9",
            "id": 38469356,
            "node_id": "MDQ6VXNlcjM4NDY5MzU2",
            "avatar_url": "https://avatars.githubusercontent.com/u/38469356?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/9lan9",
            "html_url": "https://github.com/9lan9",
            "followers_url": "https://api.github.com/users/9lan9/followers",
            "following_url": "https://api.github.com/users/9lan9/following{/other_user}",
            "gists_url": "https://api.github.com/users/9lan9/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/9lan9/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/9lan9/subscriptions",
            "organizations_url": "https://api.github.com/users/9lan9/orgs",
            "repos_url": "https://api.github.com/users/9lan9/repos",
            "events_url": "https://api.github.com/users/9lan9/events{/privacy}",
            "received_events_url": "https://api.github.com/users/9lan9/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-05-06T09:18:35Z",
        "updated_at": "2021-05-06T09:18:35Z",
        "author_association": "NONE",
        "body": "> Actually I get this error too:\r\n> \r\n> > h_offset = torch.tensor((x.shape[2] - self.crop_size) / 2)                                                                                                                                                                                                                    mtorch/deploy/transform_ops.py:62: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function\r\n> \r\n> So it is not respecting dynamic sizes?\r\n> \r\n> Can you please re-open the issue, or let me know how to fix it?\r\n> \r\n> Also, let me know if I should open issue in other repo?\r\n\r\nany solution for this?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/833372233/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]