[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857333407",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8003#issuecomment-857333407",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8003",
        "id": 857333407,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzMzMzQwNw==",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-06-09T02:59:09Z",
        "updated_at": "2021-06-09T02:59:09Z",
        "author_association": "CONTRIBUTOR",
        "body": "You can control the native library loading in Java by setting different JVM system properties on the command line (e.g. https://github.com/microsoft/onnxruntime/blob/master/java/src/main/java/ai/onnxruntime/OnnxRuntime.java#L169). The one I linked will allow you to specify the path to the native library if you've extracted it to a specific place.\r\n\r\nWhat OS & JVM are you using where it fails to clean up the temporary files?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857333407/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857342641",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8003#issuecomment-857342641",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8003",
        "id": 857342641,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzM0MjY0MQ==",
        "user": {
            "login": "hongyaohongyao",
            "id": 43579107,
            "node_id": "MDQ6VXNlcjQzNTc5MTA3",
            "avatar_url": "https://avatars.githubusercontent.com/u/43579107?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hongyaohongyao",
            "html_url": "https://github.com/hongyaohongyao",
            "followers_url": "https://api.github.com/users/hongyaohongyao/followers",
            "following_url": "https://api.github.com/users/hongyaohongyao/following{/other_user}",
            "gists_url": "https://api.github.com/users/hongyaohongyao/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hongyaohongyao/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hongyaohongyao/subscriptions",
            "organizations_url": "https://api.github.com/users/hongyaohongyao/orgs",
            "repos_url": "https://api.github.com/users/hongyaohongyao/repos",
            "events_url": "https://api.github.com/users/hongyaohongyao/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hongyaohongyao/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-06-09T03:25:58Z",
        "updated_at": "2021-06-09T03:32:35Z",
        "author_association": "NONE",
        "body": "> You can control the native library loading in Java by setting different JVM system properties on the command line (e.g. https://github.com/microsoft/onnxruntime/blob/master/java/src/main/java/ai/onnxruntime/OnnxRuntime.java#L169). The one I linked will allow you to specify the path to the native library if you've extracted it to a specific place.\r\n> \r\n> What OS & JVM are you using where it fails to clean up the temporary files?\r\n\r\nI test it on window. It create a temp dir everytime which start with \"onnxruntime-java\" and a random number behind. like this\r\n![image](https://user-images.githubusercontent.com/43579107/121288611-388a8e00-c916-11eb-91d9-c3f651b37052.png)\r\n Would you tell me the properties which I should set.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857342641/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857677171",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8003#issuecomment-857677171",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8003",
        "id": 857677171,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzY3NzE3MQ==",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-06-09T13:05:31Z",
        "updated_at": "2021-06-09T13:05:31Z",
        "author_association": "CONTRIBUTOR",
        "body": "Yes, that's a known issue with the JVM, based on how `System.loadLibrary` and `file.deleteOnExit` work. Basically we tag the native library with a shutdown hook that should delete it, but at the point where that hook is called the ORT library is still loaded into memory, and Windows won't let you delete files that are still loaded (macOS and Linux will, which is why it's only an issue on Windows). See this very old JVM bug (https://bugs.java.com/bugdatabase/view_bug.do?bug_id=4171239). If this is causing an issue then you should cache the libraries yourself and use the system properties to control library loading.\r\n\r\nDepending on which version you are using (either CPU or GPU) and what version of ORT, then you need to supply different system properties. For 1.7.0 & 1.8.0 on CPU, you should use `-Donnxruntime.native.onnxruntime.path=<path-to-onnxruntime.dll> -Donnxruntime.native.onnxruntime4j_jni.path=<path-to-onnxruntime4j_jni.dll>`. If you're using the GPU then you'll need to have similar things for `onnxruntime_providers_shared.dll` and `onnxruntime_providers_cuda.dll`.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857677171/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857744170",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8003#issuecomment-857744170",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8003",
        "id": 857744170,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg1Nzc0NDE3MA==",
        "user": {
            "login": "hongyaohongyao",
            "id": 43579107,
            "node_id": "MDQ6VXNlcjQzNTc5MTA3",
            "avatar_url": "https://avatars.githubusercontent.com/u/43579107?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hongyaohongyao",
            "html_url": "https://github.com/hongyaohongyao",
            "followers_url": "https://api.github.com/users/hongyaohongyao/followers",
            "following_url": "https://api.github.com/users/hongyaohongyao/following{/other_user}",
            "gists_url": "https://api.github.com/users/hongyaohongyao/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/hongyaohongyao/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/hongyaohongyao/subscriptions",
            "organizations_url": "https://api.github.com/users/hongyaohongyao/orgs",
            "repos_url": "https://api.github.com/users/hongyaohongyao/repos",
            "events_url": "https://api.github.com/users/hongyaohongyao/events{/privacy}",
            "received_events_url": "https://api.github.com/users/hongyaohongyao/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-06-09T14:28:12Z",
        "updated_at": "2021-06-09T14:28:12Z",
        "author_association": "NONE",
        "body": "> Yes, that's a known issue with the JVM, based on how `System.loadLibrary` and `file.deleteOnExit` work. Basically we tag the native library with a shutdown hook that should delete it, but at the point where that hook is called the ORT library is still loaded into memory, and Windows won't let you delete files that are still loaded (macOS and Linux will, which is why it's only an issue on Windows). See this very old JVM bug (https://bugs.java.com/bugdatabase/view_bug.do?bug_id=4171239). If this is causing an issue then you should cache the libraries yourself and use the system properties to control library loading.\r\n> \r\n> Depending on which version you are using (either CPU or GPU) and what version of ORT, then you need to supply different system properties. For 1.7.0 & 1.8.0 on CPU, you should use `-Donnxruntime.native.onnxruntime.path=<path-to-onnxruntime.dll> -Donnxruntime.native.onnxruntime4j_jni.path=<path-to-onnxruntime4j_jni.dll>`. If you're using the GPU then you'll need to have similar things for `onnxruntime_providers_shared.dll` and `onnxruntime_providers_cuda.dll`.\r\n\r\nThanks, I got it. But why not supply a single system property that can control the root of the library😂",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857744170/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857844433",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8003#issuecomment-857844433",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8003",
        "id": 857844433,
        "node_id": "MDEyOklzc3VlQ29tbWVudDg1Nzg0NDQzMw==",
        "user": {
            "login": "Craigacp",
            "id": 729696,
            "node_id": "MDQ6VXNlcjcyOTY5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/729696?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Craigacp",
            "html_url": "https://github.com/Craigacp",
            "followers_url": "https://api.github.com/users/Craigacp/followers",
            "following_url": "https://api.github.com/users/Craigacp/following{/other_user}",
            "gists_url": "https://api.github.com/users/Craigacp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/Craigacp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/Craigacp/subscriptions",
            "organizations_url": "https://api.github.com/users/Craigacp/orgs",
            "repos_url": "https://api.github.com/users/Craigacp/repos",
            "events_url": "https://api.github.com/users/Craigacp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/Craigacp/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-06-09T16:20:23Z",
        "updated_at": "2021-06-09T16:20:23Z",
        "author_association": "CONTRIBUTOR",
        "body": "The change to break out CUDA into separate libraries landed in 1.8.0 and I've not had chance to refactor the library loading to make it easier to use. That's work I plan to do over the next few weeks, and adding a root directory override is one of the things on the list to do.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/857844433/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]