[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/483502120",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/829#issuecomment-483502120",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/829",
        "id": 483502120,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MzUwMjEyMA==",
        "user": {
            "login": "lucienwang1009",
            "id": 28888626,
            "node_id": "MDQ6VXNlcjI4ODg4NjI2",
            "avatar_url": "https://avatars.githubusercontent.com/u/28888626?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/lucienwang1009",
            "html_url": "https://github.com/lucienwang1009",
            "followers_url": "https://api.github.com/users/lucienwang1009/followers",
            "following_url": "https://api.github.com/users/lucienwang1009/following{/other_user}",
            "gists_url": "https://api.github.com/users/lucienwang1009/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/lucienwang1009/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/lucienwang1009/subscriptions",
            "organizations_url": "https://api.github.com/users/lucienwang1009/orgs",
            "repos_url": "https://api.github.com/users/lucienwang1009/repos",
            "events_url": "https://api.github.com/users/lucienwang1009/events{/privacy}",
            "received_events_url": "https://api.github.com/users/lucienwang1009/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-16T03:58:29Z",
        "updated_at": "2019-04-16T03:58:29Z",
        "author_association": "NONE",
        "body": "> Shape inference in ONNX is designed as a \"best-effort\" component. It will do the best as it can, but nobody can't rely on it. So, there is any shape inference error, it shouldn't block onnxruntime's execution.\r\n\r\nThanks for the quick reply.\r\nHere is a real model for objection detection ([YoloV3](https://www.dropbox.com/s/v8imxaupz5mkvs4/yolov3.zip?dl=0)) that fails to be loaded into onnxruntime with a shape inference error but succeed to run if shape inference is disabled.\r\nIt seems onnxrutime just screw up if encountering any exception when invoking onnx: https://github.com/Microsoft/onnxruntime/blob/f19d9a490798a5b9769940db238c6119907a8a67/onnxruntime/core/graph/graph.cc#L1499-L1503",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/483502120/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/483563652",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/829#issuecomment-483563652",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/829",
        "id": 483563652,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MzU2MzY1Mg==",
        "user": {
            "login": "lucienwang1009",
            "id": 28888626,
            "node_id": "MDQ6VXNlcjI4ODg4NjI2",
            "avatar_url": "https://avatars.githubusercontent.com/u/28888626?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/lucienwang1009",
            "html_url": "https://github.com/lucienwang1009",
            "followers_url": "https://api.github.com/users/lucienwang1009/followers",
            "following_url": "https://api.github.com/users/lucienwang1009/following{/other_user}",
            "gists_url": "https://api.github.com/users/lucienwang1009/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/lucienwang1009/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/lucienwang1009/subscriptions",
            "organizations_url": "https://api.github.com/users/lucienwang1009/orgs",
            "repos_url": "https://api.github.com/users/lucienwang1009/repos",
            "events_url": "https://api.github.com/users/lucienwang1009/events{/privacy}",
            "received_events_url": "https://api.github.com/users/lucienwang1009/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-16T08:29:10Z",
        "updated_at": "2019-04-16T08:29:10Z",
        "author_association": "NONE",
        "body": "Here is a simple example to show this issue. Test on master branch.\r\n``` python\r\nimport onnx\r\nfrom onnx import helper, numpy_helper, shape_inference\r\nfrom onnx import AttributeProto, TensorProto, GraphProto\r\nimport numpy as np\r\nimport onnxruntime\r\n\r\n# The protobuf definition can be found here:\r\n# https://github.com/onnx/onnx/blob/master/onnx/onnx.proto\r\n\r\n\r\n# Create one input (ValueInfoProto)\r\nA = helper.make_tensor_value_info('A', TensorProto.INT32, [2])\r\nB = helper.make_tensor_value_info('B', TensorProto.FLOAT, [4])\r\nC = helper.make_tensor_value_info('C', TensorProto.FLOAT, [2, 2])\r\n\r\n# Create one output (ValueInfoProto)\r\nY = helper.make_tensor_value_info('Y', TensorProto.FLOAT, [2, 2])\r\n\r\n# Create a node (NodeProto)\r\ncast = helper.make_node(\r\n    \"Cast\",\r\n    inputs=[\"A\"],\r\n    outputs=[\"cast\"],\r\n    to=TensorProto.INT64\r\n)\r\nreshape = helper.make_node(\r\n    \"Reshape\",\r\n    inputs=[\"B\", \"cast\"],\r\n    outputs=[\"reshape\"],\r\n)\r\nmatmul = helper.make_node(\r\n    'MatMul', # node name\r\n    inputs=['reshape', 'C'], # inputs\r\n    outputs=['Y'], # outputs\r\n)\r\n\r\ninitializers = [\r\n    numpy_helper.from_array(\r\n        np.array([2, 2], dtype=np.int32),\r\n        name='A'\r\n    ),\r\n    numpy_helper.from_array(\r\n        np.array([1, 2, 3, 4], dtype=np.float32),\r\n        name='B'\r\n    ),\r\n    numpy_helper.from_array(\r\n        np.array([[1, 2], [3, 4]], dtype=np.float32),\r\n        name='C'\r\n    )\r\n]\r\n\r\n# Create the graph (GraphProto)\r\ngraph_def = helper.make_graph(\r\n    [cast, reshape, matmul],\r\n    \"test-model\",\r\n    [A, B, C],\r\n    [Y],\r\n    initializers\r\n)\r\n\r\n# Create the model (ModelProto)\r\nmodel_def = helper.make_model(graph_def,\r\n                              producer_name='onnx-example')\r\n\r\nshape_inference.infer_shapes(model_def)\r\n\r\n\r\nprint('The ir_version in model: {}\\n'.format(model_def.ir_version))\r\nprint('The producer_name in model: {}\\n'.format(model_def.producer_name))\r\nprint('The graph in model:\\n{}'.format(model_def.graph))\r\nonnx.checker.check_model(model_def)\r\nprint('The model is checked!')\r\nonnx.save(model_def, \"model.onnx\")\r\n\r\nsess = onnxruntime.InferenceSession(\"model.onnx\")\r\nlotus_result = sess.run(['Y'], {})\r\nprint(lotus_result)\r\n```\r\n\r\nIt will throw `[ShapeInferenceError] Input tensors of wrong rank (0)` that comes from https://github.com/onnx/onnx/blob/3717dc617fa06e4eea326e85dc0ccfdcdf4f4ab5/onnx/defs/math/defs.cc#L754-L763. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/483563652/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/484340368",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/829#issuecomment-484340368",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/829",
        "id": 484340368,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDM0MDM2OA==",
        "user": {
            "login": "zhijxu-MS",
            "id": 43435212,
            "node_id": "MDQ6VXNlcjQzNDM1MjEy",
            "avatar_url": "https://avatars.githubusercontent.com/u/43435212?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/zhijxu-MS",
            "html_url": "https://github.com/zhijxu-MS",
            "followers_url": "https://api.github.com/users/zhijxu-MS/followers",
            "following_url": "https://api.github.com/users/zhijxu-MS/following{/other_user}",
            "gists_url": "https://api.github.com/users/zhijxu-MS/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/zhijxu-MS/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zhijxu-MS/subscriptions",
            "organizations_url": "https://api.github.com/users/zhijxu-MS/orgs",
            "repos_url": "https://api.github.com/users/zhijxu-MS/repos",
            "events_url": "https://api.github.com/users/zhijxu-MS/events{/privacy}",
            "received_events_url": "https://api.github.com/users/zhijxu-MS/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-18T03:16:08Z",
        "updated_at": "2019-04-18T03:16:08Z",
        "author_association": "MEMBER",
        "body": "we encountered a similar problem. shape inference of \"slice\" in onnx has a bug, and onnxruntime will throw an exception directly, **while if I disable slice's shape inference then onnxruntime can run the model and its output is right.**",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/484340368/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/484747298",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/829#issuecomment-484747298",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/829",
        "id": 484747298,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDc0NzI5OA==",
        "user": {
            "login": "snnn",
            "id": 856316,
            "node_id": "MDQ6VXNlcjg1NjMxNg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/856316?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/snnn",
            "html_url": "https://github.com/snnn",
            "followers_url": "https://api.github.com/users/snnn/followers",
            "following_url": "https://api.github.com/users/snnn/following{/other_user}",
            "gists_url": "https://api.github.com/users/snnn/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/snnn/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/snnn/subscriptions",
            "organizations_url": "https://api.github.com/users/snnn/orgs",
            "repos_url": "https://api.github.com/users/snnn/repos",
            "events_url": "https://api.github.com/users/snnn/events{/privacy}",
            "received_events_url": "https://api.github.com/users/snnn/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-19T02:23:19Z",
        "updated_at": "2019-04-19T02:23:19Z",
        "author_association": "MEMBER",
        "body": "In order to not create more confusion, I'll close this PR.\r\nFor any type and shape inference exception thrown from ONNX, it's an error, it must get fixed in ONNX.\r\nIf you think runtime should ignore this exception and continue to run, then please don't throw exception.\r\nShape inference is optional, but type inference is a must. Type inference must finish successfully.\r\n\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/484747298/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/484750540",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/829#issuecomment-484750540",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/829",
        "id": 484750540,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDc1MDU0MA==",
        "user": {
            "login": "lucienwang1009",
            "id": 28888626,
            "node_id": "MDQ6VXNlcjI4ODg4NjI2",
            "avatar_url": "https://avatars.githubusercontent.com/u/28888626?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/lucienwang1009",
            "html_url": "https://github.com/lucienwang1009",
            "followers_url": "https://api.github.com/users/lucienwang1009/followers",
            "following_url": "https://api.github.com/users/lucienwang1009/following{/other_user}",
            "gists_url": "https://api.github.com/users/lucienwang1009/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/lucienwang1009/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/lucienwang1009/subscriptions",
            "organizations_url": "https://api.github.com/users/lucienwang1009/orgs",
            "repos_url": "https://api.github.com/users/lucienwang1009/repos",
            "events_url": "https://api.github.com/users/lucienwang1009/events{/privacy}",
            "received_events_url": "https://api.github.com/users/lucienwang1009/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-19T02:46:11Z",
        "updated_at": "2019-04-19T02:46:11Z",
        "author_association": "NONE",
        "body": "> In order to not create more confusion, I'll close this PR.\r\n> For any type and shape inference exception thrown from ONNX, it's an error, it must get fixed in ONNX.\r\n> If you think runtime should ignore this exception and continue to run, then please don't throw exception.\r\n> Shape inference is optional, but type inference is a must. Type inference must finish successfully.\r\n\r\nThanks for these explanations.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/484750540/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/484964592",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/829#issuecomment-484964592",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/829",
        "id": 484964592,
        "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDk2NDU5Mg==",
        "user": {
            "login": "askhade",
            "id": 6475296,
            "node_id": "MDQ6VXNlcjY0NzUyOTY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6475296?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/askhade",
            "html_url": "https://github.com/askhade",
            "followers_url": "https://api.github.com/users/askhade/followers",
            "following_url": "https://api.github.com/users/askhade/following{/other_user}",
            "gists_url": "https://api.github.com/users/askhade/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/askhade/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/askhade/subscriptions",
            "organizations_url": "https://api.github.com/users/askhade/orgs",
            "repos_url": "https://api.github.com/users/askhade/repos",
            "events_url": "https://api.github.com/users/askhade/events{/privacy}",
            "received_events_url": "https://api.github.com/users/askhade/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-04-19T17:30:01Z",
        "updated_at": "2019-04-19T17:32:21Z",
        "author_association": "MEMBER",
        "body": "The shape inference bugs with 2 ops mentioned in this issue are fixed and checked in. Refer to \r\nMatMul Shape Inference Fix : https://github.com/onnx/onnx/pull/1941\r\nConstantOfShape Shape Inference Fix: https://github.com/onnx/onnx/pull/1951 ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/484964592/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/526130037",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/829#issuecomment-526130037",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/829",
        "id": 526130037,
        "node_id": "MDEyOklzc3VlQ29tbWVudDUyNjEzMDAzNw==",
        "user": {
            "login": "amanarora28",
            "id": 16681674,
            "node_id": "MDQ6VXNlcjE2NjgxNjc0",
            "avatar_url": "https://avatars.githubusercontent.com/u/16681674?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/amanarora28",
            "html_url": "https://github.com/amanarora28",
            "followers_url": "https://api.github.com/users/amanarora28/followers",
            "following_url": "https://api.github.com/users/amanarora28/following{/other_user}",
            "gists_url": "https://api.github.com/users/amanarora28/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/amanarora28/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/amanarora28/subscriptions",
            "organizations_url": "https://api.github.com/users/amanarora28/orgs",
            "repos_url": "https://api.github.com/users/amanarora28/repos",
            "events_url": "https://api.github.com/users/amanarora28/events{/privacy}",
            "received_events_url": "https://api.github.com/users/amanarora28/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2019-08-29T10:40:40Z",
        "updated_at": "2019-08-29T10:40:40Z",
        "author_association": "NONE",
        "body": "Hey, how can I disable shape inference in onnx runtime? \r\nI am facing [ShapeInferenceError] for Mismatch between number of source and target dimensions",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/526130037/reactions",
            "total_count": 6,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 6
        },
        "performed_via_github_app": null
    }
]