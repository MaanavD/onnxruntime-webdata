[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/894404837",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8637#issuecomment-894404837",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8637",
        "id": 894404837,
        "node_id": "IC_kwDOCVq1mM41T4jl",
        "user": {
            "login": "wangyems",
            "id": 52801275,
            "node_id": "MDQ6VXNlcjUyODAxMjc1",
            "avatar_url": "https://avatars.githubusercontent.com/u/52801275?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wangyems",
            "html_url": "https://github.com/wangyems",
            "followers_url": "https://api.github.com/users/wangyems/followers",
            "following_url": "https://api.github.com/users/wangyems/following{/other_user}",
            "gists_url": "https://api.github.com/users/wangyems/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wangyems/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wangyems/subscriptions",
            "organizations_url": "https://api.github.com/users/wangyems/orgs",
            "repos_url": "https://api.github.com/users/wangyems/repos",
            "events_url": "https://api.github.com/users/wangyems/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wangyems/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-06T17:23:16Z",
        "updated_at": "2021-08-06T17:27:51Z",
        "author_association": "MEMBER",
        "body": "Thanks for reporting. I'll send a PR optimizing huggingface/bart model\r\nCan you please provide the transformers version?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/894404837/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/894612698",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8637#issuecomment-894612698",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8637",
        "id": 894612698,
        "node_id": "IC_kwDOCVq1mM41UrTa",
        "user": {
            "login": "leoozy",
            "id": 26025961,
            "node_id": "MDQ6VXNlcjI2MDI1OTYx",
            "avatar_url": "https://avatars.githubusercontent.com/u/26025961?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/leoozy",
            "html_url": "https://github.com/leoozy",
            "followers_url": "https://api.github.com/users/leoozy/followers",
            "following_url": "https://api.github.com/users/leoozy/following{/other_user}",
            "gists_url": "https://api.github.com/users/leoozy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/leoozy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/leoozy/subscriptions",
            "organizations_url": "https://api.github.com/users/leoozy/orgs",
            "repos_url": "https://api.github.com/users/leoozy/repos",
            "events_url": "https://api.github.com/users/leoozy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/leoozy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-07T06:21:57Z",
        "updated_at": "2021-08-07T06:21:57Z",
        "author_association": "NONE",
        "body": "@wangyems Hello, the transformers version is 4.9.1",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/894612698/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/895779439",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8637#issuecomment-895779439",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8637",
        "id": 895779439,
        "node_id": "IC_kwDOCVq1mM41ZIJv",
        "user": {
            "login": "wangyems",
            "id": 52801275,
            "node_id": "MDQ6VXNlcjUyODAxMjc1",
            "avatar_url": "https://avatars.githubusercontent.com/u/52801275?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wangyems",
            "html_url": "https://github.com/wangyems",
            "followers_url": "https://api.github.com/users/wangyems/followers",
            "following_url": "https://api.github.com/users/wangyems/following{/other_user}",
            "gists_url": "https://api.github.com/users/wangyems/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wangyems/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wangyems/subscriptions",
            "organizations_url": "https://api.github.com/users/wangyems/orgs",
            "repos_url": "https://api.github.com/users/wangyems/repos",
            "events_url": "https://api.github.com/users/wangyems/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wangyems/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-10T06:59:54Z",
        "updated_at": "2021-08-10T06:59:54Z",
        "author_association": "MEMBER",
        "body": "@leoozy It's suggested to use ORT iobinding to have a fair comparison with pytorch.\r\nhttps://onnxruntime.ai/python/api_summary#iobinding",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/895779439/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/895782757",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8637#issuecomment-895782757",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8637",
        "id": 895782757,
        "node_id": "IC_kwDOCVq1mM41ZI9l",
        "user": {
            "login": "leoozy",
            "id": 26025961,
            "node_id": "MDQ6VXNlcjI2MDI1OTYx",
            "avatar_url": "https://avatars.githubusercontent.com/u/26025961?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/leoozy",
            "html_url": "https://github.com/leoozy",
            "followers_url": "https://api.github.com/users/leoozy/followers",
            "following_url": "https://api.github.com/users/leoozy/following{/other_user}",
            "gists_url": "https://api.github.com/users/leoozy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/leoozy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/leoozy/subscriptions",
            "organizations_url": "https://api.github.com/users/leoozy/orgs",
            "repos_url": "https://api.github.com/users/leoozy/repos",
            "events_url": "https://api.github.com/users/leoozy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/leoozy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-10T07:05:01Z",
        "updated_at": "2021-08-10T07:05:01Z",
        "author_association": "NONE",
        "body": "@wangyems \r\nHello, Actually for pytorch model, my code is: \r\n\r\ndef evaluate_hg(model_path):\r\n\r\n    for i in range(50):\r\n        torch.cuda.synchronize()\r\n        start = time.time()\r\n        input_hg = inputs.cuda()\r\n\r\n        model(input_hg)\r\n        torch.cuda.synchronize()\r\n        latency2.append(time.time() - start)\r\n    print(latency2)\r\n\r\n\r\nI record the time transfering inputs from cpu to gpu for hg model. I've also tired tie IO BLINDING:\r\ndef evaluate_onnx(model_path):\r\n\r\n    execution_providers = ['CUDAExecutionProvider', 'CPUExecutionProvider']\r\n    sess_options = onnxruntime.SessionOptions()\r\n\r\n    sess_options.execution_mode = onnxruntime.ExecutionMode.ORT_SEQUENTIAL\r\n    sess_options.graph_optimization_level = onnxruntime.GraphOptimizationLevel.ORT_ENABLE_EXTENDED\r\n    sess_options.intra_op_num_threads = 128\r\n    session = onnxruntime.InferenceSession(model_path, sess_options, providers=execution_providers)\r\n\r\n    io_binding = session.io_binding()\r\n    io_binding.bind_cpu_input('input_ids', inputs.numpy())\r\n    io_binding.bind_output('logits')\r\n    assert 'CUDAExecutionProvider' in session.get_providers()\r\n    for i in range(20):\r\n        start = time.time()\r\n        session.run_with_iobinding(io_binding)\r\n        latency1.append(time.time() - start)\r\n    print(latency1)\r\n\r\nBut it is still slower than the fp32 hg model",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/895782757/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/896541456",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/8637#issuecomment-896541456",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/8637",
        "id": 896541456,
        "node_id": "IC_kwDOCVq1mM41cCMQ",
        "user": {
            "login": "leoozy",
            "id": 26025961,
            "node_id": "MDQ6VXNlcjI2MDI1OTYx",
            "avatar_url": "https://avatars.githubusercontent.com/u/26025961?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/leoozy",
            "html_url": "https://github.com/leoozy",
            "followers_url": "https://api.github.com/users/leoozy/followers",
            "following_url": "https://api.github.com/users/leoozy/following{/other_user}",
            "gists_url": "https://api.github.com/users/leoozy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/leoozy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/leoozy/subscriptions",
            "organizations_url": "https://api.github.com/users/leoozy/orgs",
            "repos_url": "https://api.github.com/users/leoozy/repos",
            "events_url": "https://api.github.com/users/leoozy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/leoozy/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-08-11T06:35:16Z",
        "updated_at": "2021-08-11T06:35:16Z",
        "author_association": "NONE",
        "body": "Hello, is there any update? Thank you! @wangyems",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/896541456/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]