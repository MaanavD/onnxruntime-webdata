[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/924210670",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9117#issuecomment-924210670",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9117",
        "id": 924210670,
        "node_id": "IC_kwDOCVq1mM43FlXu",
        "user": {
            "login": "fs-eire",
            "id": 7679871,
            "node_id": "MDQ6VXNlcjc2Nzk4NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7679871?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fs-eire",
            "html_url": "https://github.com/fs-eire",
            "followers_url": "https://api.github.com/users/fs-eire/followers",
            "following_url": "https://api.github.com/users/fs-eire/following{/other_user}",
            "gists_url": "https://api.github.com/users/fs-eire/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fs-eire/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fs-eire/subscriptions",
            "organizations_url": "https://api.github.com/users/fs-eire/orgs",
            "repos_url": "https://api.github.com/users/fs-eire/repos",
            "events_url": "https://api.github.com/users/fs-eire/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fs-eire/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-21T17:38:54Z",
        "updated_at": "2021-09-21T17:38:54Z",
        "author_association": "MEMBER",
        "body": "Thanks for the feedback.\r\n\r\nThe behavior is expected as we only set `numThreads` to intraop but always set interop to 1:\r\nhttps://github.com/microsoft/onnxruntime/blob/master/onnxruntime/wasm/api.cc#L50-L51\r\n\r\nThis design decision is made by that we assume models for web scenario will not be a heavy model so that most of the time parallelization between kernels contributes to limited inferencing gain, especially when we use the limited CPU cores to perform intraop accelerations.\r\n\r\nplease note that parallelization inside a kernel (intra) still works no matter execution mode is \"sequential\" or \"parallel\" (inter).\r\n",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/924210670/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/924252577",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9117#issuecomment-924252577",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9117",
        "id": 924252577,
        "node_id": "IC_kwDOCVq1mM43Fvmh",
        "user": {
            "login": "benpm",
            "id": 10006314,
            "node_id": "MDQ6VXNlcjEwMDA2MzE0",
            "avatar_url": "https://avatars.githubusercontent.com/u/10006314?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/benpm",
            "html_url": "https://github.com/benpm",
            "followers_url": "https://api.github.com/users/benpm/followers",
            "following_url": "https://api.github.com/users/benpm/following{/other_user}",
            "gists_url": "https://api.github.com/users/benpm/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/benpm/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/benpm/subscriptions",
            "organizations_url": "https://api.github.com/users/benpm/orgs",
            "repos_url": "https://api.github.com/users/benpm/repos",
            "events_url": "https://api.github.com/users/benpm/events{/privacy}",
            "received_events_url": "https://api.github.com/users/benpm/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-21T18:31:34Z",
        "updated_at": "2021-09-21T18:31:34Z",
        "author_association": "NONE",
        "body": "So setting it to \"parallel\" execution mode has no effect?",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/924252577/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/924295370",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9117#issuecomment-924295370",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9117",
        "id": 924295370,
        "node_id": "IC_kwDOCVq1mM43F6DK",
        "user": {
            "login": "benpm",
            "id": 10006314,
            "node_id": "MDQ6VXNlcjEwMDA2MzE0",
            "avatar_url": "https://avatars.githubusercontent.com/u/10006314?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/benpm",
            "html_url": "https://github.com/benpm",
            "followers_url": "https://api.github.com/users/benpm/followers",
            "following_url": "https://api.github.com/users/benpm/following{/other_user}",
            "gists_url": "https://api.github.com/users/benpm/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/benpm/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/benpm/subscriptions",
            "organizations_url": "https://api.github.com/users/benpm/orgs",
            "repos_url": "https://api.github.com/users/benpm/repos",
            "events_url": "https://api.github.com/users/benpm/events{/privacy}",
            "received_events_url": "https://api.github.com/users/benpm/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-21T18:57:47Z",
        "updated_at": "2021-09-21T18:57:47Z",
        "author_association": "NONE",
        "body": "Okay, so I understand now that the error message is expected. However, I'm not seeing any significant difference in run time between running the model with `numThreads: 1` and `numThreads: 16`.\r\n\r\n`numThreads=16`: 6.294 sec\r\n`numThreads=1`: 6.212 sec\r\n\r\nInspecting in htop, I can also see that there is only one core being heavily used:\r\n\r\n![image](https://user-images.githubusercontent.com/10006314/134230840-114f3240-deb6-4c3f-bc79-379d8babe401.png)",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/924295370/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/925191448",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9117#issuecomment-925191448",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9117",
        "id": 925191448,
        "node_id": "IC_kwDOCVq1mM43JU0Y",
        "user": {
            "login": "fs-eire",
            "id": 7679871,
            "node_id": "MDQ6VXNlcjc2Nzk4NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7679871?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fs-eire",
            "html_url": "https://github.com/fs-eire",
            "followers_url": "https://api.github.com/users/fs-eire/followers",
            "following_url": "https://api.github.com/users/fs-eire/following{/other_user}",
            "gists_url": "https://api.github.com/users/fs-eire/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fs-eire/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fs-eire/subscriptions",
            "organizations_url": "https://api.github.com/users/fs-eire/orgs",
            "repos_url": "https://api.github.com/users/fs-eire/repos",
            "events_url": "https://api.github.com/users/fs-eire/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fs-eire/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-22T18:38:35Z",
        "updated_at": "2021-09-22T18:38:35Z",
        "author_association": "MEMBER",
        "body": "\r\ndid you check if the web worker threads are actually created? you can refer to the \"Sources\" tab in chrome's devtool. if there is only one thread, it means the browser environment is not capable to run multi-thread wasm (make sure `--enable-features=SharedArrayBuffer` is passed )\r\n\r\ndid you run warmups? the webworker threads are created asynchronously. if you call session.run() immediately after session created, the worker threads may not be ready yet.\r\n\r\ndid you try other numThreads configuration like, `numThreads=2` to compare with `numThreads=1`? sometimes too many threads may cause the overhead become significant to slow down the overall inference time\r\n\r\nAlso please try to disable verbose logging and debug mode.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/925191448/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/925433848",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9117#issuecomment-925433848",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9117",
        "id": 925433848,
        "node_id": "IC_kwDOCVq1mM43KP_4",
        "user": {
            "login": "haydn-jones",
            "id": 9584084,
            "node_id": "MDQ6VXNlcjk1ODQwODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9584084?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/haydn-jones",
            "html_url": "https://github.com/haydn-jones",
            "followers_url": "https://api.github.com/users/haydn-jones/followers",
            "following_url": "https://api.github.com/users/haydn-jones/following{/other_user}",
            "gists_url": "https://api.github.com/users/haydn-jones/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/haydn-jones/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/haydn-jones/subscriptions",
            "organizations_url": "https://api.github.com/users/haydn-jones/orgs",
            "repos_url": "https://api.github.com/users/haydn-jones/repos",
            "events_url": "https://api.github.com/users/haydn-jones/events{/privacy}",
            "received_events_url": "https://api.github.com/users/haydn-jones/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-23T00:53:42Z",
        "updated_at": "2021-09-23T00:53:42Z",
        "author_association": "NONE",
        "body": "> did you check if the web worker threads are actually created? you can refer to the \"Sources\" tab in chrome's devtool. if there is only one thread, it means the browser environment is not capable to run multi-thread wasm (make sure `--enable-features=SharedArrayBuffer` is passed )\r\n> \r\n> did you run warmups? the webworker threads are created asynchronously. if you call session.run() immediately after session created, the worker threads may not be ready yet.\r\n> \r\n> did you try other numThreads configuration like, `numThreads=2` to compare with `numThreads=1`? sometimes too many threads may cause the overhead become significant to slow down the overall inference time\r\n> \r\n> Also please try to disable verbose logging and debug mode.\r\n\r\nWorking on this with @benpm. Waiting for the threads to be ready may be a solution for us. We will do some testing and get back to you. Thanks!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/925433848/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/925500090",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9117#issuecomment-925500090",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9117",
        "id": 925500090,
        "node_id": "IC_kwDOCVq1mM43KgK6",
        "user": {
            "login": "haydn-jones",
            "id": 9584084,
            "node_id": "MDQ6VXNlcjk1ODQwODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/9584084?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/haydn-jones",
            "html_url": "https://github.com/haydn-jones",
            "followers_url": "https://api.github.com/users/haydn-jones/followers",
            "following_url": "https://api.github.com/users/haydn-jones/following{/other_user}",
            "gists_url": "https://api.github.com/users/haydn-jones/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/haydn-jones/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/haydn-jones/subscriptions",
            "organizations_url": "https://api.github.com/users/haydn-jones/orgs",
            "repos_url": "https://api.github.com/users/haydn-jones/repos",
            "events_url": "https://api.github.com/users/haydn-jones/events{/privacy}",
            "received_events_url": "https://api.github.com/users/haydn-jones/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-23T04:29:51Z",
        "updated_at": "2021-09-23T04:29:51Z",
        "author_association": "NONE",
        "body": "Waiting 1 second is consistently allowing the model to run in parallel, thanks for the tip!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/925500090/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]