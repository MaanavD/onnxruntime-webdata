[
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/926055612",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9161#issuecomment-926055612",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9161",
        "id": 926055612,
        "node_id": "IC_kwDOCVq1mM43Mny8",
        "user": {
            "login": "fs-eire",
            "id": 7679871,
            "node_id": "MDQ6VXNlcjc2Nzk4NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7679871?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fs-eire",
            "html_url": "https://github.com/fs-eire",
            "followers_url": "https://api.github.com/users/fs-eire/followers",
            "following_url": "https://api.github.com/users/fs-eire/following{/other_user}",
            "gists_url": "https://api.github.com/users/fs-eire/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fs-eire/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fs-eire/subscriptions",
            "organizations_url": "https://api.github.com/users/fs-eire/orgs",
            "repos_url": "https://api.github.com/users/fs-eire/repos",
            "events_url": "https://api.github.com/users/fs-eire/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fs-eire/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-23T18:30:10Z",
        "updated_at": "2021-09-23T18:30:10Z",
        "author_association": "MEMBER",
        "body": "Thank you for your feedback.\r\n\r\nonnxruntime-python is a python language binding of the native ONNX Runtime, which utilize all available platform and OS features to accelerate ONNX Runtime model inferencing. This is similar to ORT Java binding, C# binding and Node.js (javascript) binding.\r\n\r\nonnxruntime-web is not using the native ONNX Runtime. Because of the restriction on browser, a website cannot run native libraries on client's device. We utilize WebAssembly to make ONNX Runtime running inside a browser. This means it will not going to beat native performance. We do expect onnxruntime-web is slower than native ORT. If you want to use JavaScript on server, onnxruntime-node (ORT node.js binding) is recommended.\r\n\r\nHowever, 25x slower is too slow, it is not expected. I will take a look at the model and profile to see how we can improve.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/926055612/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/926098452",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9161#issuecomment-926098452",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9161",
        "id": 926098452,
        "node_id": "IC_kwDOCVq1mM43MyQU",
        "user": {
            "login": "jobergum",
            "id": 20928528,
            "node_id": "MDQ6VXNlcjIwOTI4NTI4",
            "avatar_url": "https://avatars.githubusercontent.com/u/20928528?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jobergum",
            "html_url": "https://github.com/jobergum",
            "followers_url": "https://api.github.com/users/jobergum/followers",
            "following_url": "https://api.github.com/users/jobergum/following{/other_user}",
            "gists_url": "https://api.github.com/users/jobergum/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jobergum/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jobergum/subscriptions",
            "organizations_url": "https://api.github.com/users/jobergum/orgs",
            "repos_url": "https://api.github.com/users/jobergum/repos",
            "events_url": "https://api.github.com/users/jobergum/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jobergum/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-23T19:36:32Z",
        "updated_at": "2021-09-23T19:36:32Z",
        "author_association": "NONE",
        "body": "Thank you @fs-eire for getting back to me with a long reply, deeply appreciate it!\r\n\r\nI'm not expecting it to be close to the native onnx-rt with all the magic hw accelerations through MLAS etc but was hoping for guidance on if the observations matched up with your expectations. \r\n\r\nWith native onnx-rt using MiniLM/transformer based models we can reduce latency by tuning intrathreads to a sweet spot between latency/throughput, but in my testing with onnxruntime-web I was not seeing any latency improvement. \r\n\r\nThanks again! ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/926098452/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/926152366",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9161#issuecomment-926152366",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9161",
        "id": 926152366,
        "node_id": "IC_kwDOCVq1mM43M_au",
        "user": {
            "login": "fs-eire",
            "id": 7679871,
            "node_id": "MDQ6VXNlcjc2Nzk4NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7679871?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fs-eire",
            "html_url": "https://github.com/fs-eire",
            "followers_url": "https://api.github.com/users/fs-eire/followers",
            "following_url": "https://api.github.com/users/fs-eire/following{/other_user}",
            "gists_url": "https://api.github.com/users/fs-eire/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fs-eire/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fs-eire/subscriptions",
            "organizations_url": "https://api.github.com/users/fs-eire/orgs",
            "repos_url": "https://api.github.com/users/fs-eire/repos",
            "events_url": "https://api.github.com/users/fs-eire/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fs-eire/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-23T20:57:57Z",
        "updated_at": "2021-09-23T20:57:57Z",
        "author_association": "MEMBER",
        "body": "With some analysis, I figured out that the top 2 slowest Nodes are **DynamicQuantizeMatMul** and **MatMulIntegerToFloat**. They both call [`MlasGemmBatch`](https://github.com/microsoft/onnxruntime/blob/master/onnxruntime/core/mlas/lib/qgemm.cpp#L145) in **qgemm**.\r\n\r\nIt looks like MLAS does not enable SIMD for QGEMM on WebAssembly. This should be a big perf improvement to support U8x16 (WebAssembly uses SIMD128).",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/926152366/reactions",
            "total_count": 2,
            "+1": 2,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/929977369",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9161#issuecomment-929977369",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9161",
        "id": 929977369,
        "node_id": "IC_kwDOCVq1mM43blQZ",
        "user": {
            "login": "jobergum",
            "id": 20928528,
            "node_id": "MDQ6VXNlcjIwOTI4NTI4",
            "avatar_url": "https://avatars.githubusercontent.com/u/20928528?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jobergum",
            "html_url": "https://github.com/jobergum",
            "followers_url": "https://api.github.com/users/jobergum/followers",
            "following_url": "https://api.github.com/users/jobergum/following{/other_user}",
            "gists_url": "https://api.github.com/users/jobergum/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jobergum/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jobergum/subscriptions",
            "organizations_url": "https://api.github.com/users/jobergum/orgs",
            "repos_url": "https://api.github.com/users/jobergum/repos",
            "events_url": "https://api.github.com/users/jobergum/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jobergum/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-29T08:56:49Z",
        "updated_at": "2021-09-29T08:56:49Z",
        "author_association": "NONE",
        "body": "Thanks for the work on this @fs-eire ! Looking forward to seeing the improvement from https://github.com/microsoft/onnxruntime/pull/9191 once merged and in a release. ",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/929977369/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/931617100",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9161#issuecomment-931617100",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9161",
        "id": 931617100,
        "node_id": "IC_kwDOCVq1mM43h1lM",
        "user": {
            "login": "fs-eire",
            "id": 7679871,
            "node_id": "MDQ6VXNlcjc2Nzk4NzE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7679871?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fs-eire",
            "html_url": "https://github.com/fs-eire",
            "followers_url": "https://api.github.com/users/fs-eire/followers",
            "following_url": "https://api.github.com/users/fs-eire/following{/other_user}",
            "gists_url": "https://api.github.com/users/fs-eire/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/fs-eire/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fs-eire/subscriptions",
            "organizations_url": "https://api.github.com/users/fs-eire/orgs",
            "repos_url": "https://api.github.com/users/fs-eire/repos",
            "events_url": "https://api.github.com/users/fs-eire/events{/privacy}",
            "received_events_url": "https://api.github.com/users/fs-eire/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-09-30T19:51:51Z",
        "updated_at": "2021-09-30T19:51:51Z",
        "author_association": "MEMBER",
        "body": "The change is merged. please try the latest master build ( use [this link](https://dev.azure.com/onnxruntime/onnxruntime/_build/results?buildId=504679&view=results) for build artifacts ).\r\n\r\nBy the way, it takes some time for VM to JIT wasm for the first run. You may give a few warmup runs before check the performance number.",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/931617100/reactions",
            "total_count": 1,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 1,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    },
    {
        "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/931982433",
        "html_url": "https://github.com/microsoft/onnxruntime/issues/9161#issuecomment-931982433",
        "issue_url": "https://api.github.com/repos/microsoft/onnxruntime/issues/9161",
        "id": 931982433,
        "node_id": "IC_kwDOCVq1mM43jOxh",
        "user": {
            "login": "jobergum",
            "id": 20928528,
            "node_id": "MDQ6VXNlcjIwOTI4NTI4",
            "avatar_url": "https://avatars.githubusercontent.com/u/20928528?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jobergum",
            "html_url": "https://github.com/jobergum",
            "followers_url": "https://api.github.com/users/jobergum/followers",
            "following_url": "https://api.github.com/users/jobergum/following{/other_user}",
            "gists_url": "https://api.github.com/users/jobergum/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/jobergum/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jobergum/subscriptions",
            "organizations_url": "https://api.github.com/users/jobergum/orgs",
            "repos_url": "https://api.github.com/users/jobergum/repos",
            "events_url": "https://api.github.com/users/jobergum/events{/privacy}",
            "received_events_url": "https://api.github.com/users/jobergum/received_events",
            "type": "User",
            "site_admin": false
        },
        "created_at": "2021-10-01T07:33:43Z",
        "updated_at": "2021-10-01T07:33:43Z",
        "author_association": "NONE",
        "body": "Awesome @fs-eire ! I'm happy to report a very significant improvement. **6X**. 🚀 🚀 🚀  \r\n\r\nI've expanded the example I gave to handle text input and for the same input length I see 6X latency improvement after downloading the artifacts. Before (released) and after (build artifacts) inference latency for the exact same input. \r\n\r\n![image](https://user-images.githubusercontent.com/20928528/135582423-e436cba0-76a9-422b-8ab3-56c126af6334.png)\r\n\r\n![image](https://user-images.githubusercontent.com/20928528/135582463-9b69bd3a-09a7-4e83-a846-23f1de932542.png)\r\n\r\nThanks a lot for optimizing this, onnx-web is awesome!",
        "reactions": {
            "url": "https://api.github.com/repos/microsoft/onnxruntime/issues/comments/931982433/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
        },
        "performed_via_github_app": null
    }
]